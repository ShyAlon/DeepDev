angular.module("DeepDev.controllers").controller("searchCtrl",["$scope","$rootScope","$http","$window","$location","$animate","$timeout","$routeParams","server","local","authentication","ui",function(n,t,i,r,u,f,e,o,s,h,c,l){var a,y;n.$on("$viewContentLoaded",function(){console.log("In Search");c.initialize(a);n.subitem="Requirement";t.hide=!1;t.loading=!0});a=function(){t.wizardItem=null;n.availableSearchParams=[{key:"name",name:"Name",placeholder:"Name..."},{key:"tag",name:"Tag",placeholder:"Tag..."},{key:"status",name:"Status",placeholder:"Status..."},{key:"risk",name:"Risk",placeholder:"Risk..."},{key:"owner",name:"Owner",placeholder:"Owner..."},{key:"deadline",name:"Deadline",placeholder:"Deadline after..."},];h.initialize(null,n,v)};n.searchRequest=function(){if(n.hasNoKeys(n.searchParams)){console.log("No query");return}var t={id:-1,params:n.searchParams};s.commitEntity(t,function(n){v(n);console.log("Saved tag "+t)},function(n){console.log("Failed to set search "+n);console.log(n)},"SearchRequest")};var v=function(n){t.searchResults=n.Results},p=function(n){t.data.Children.Methods.push(n)},w=function(n){t.loading=!1;console.log("Failed to get projects for user in  "+u.path());console.log(n)},b=function(){l.configureDatetimepicker(n);l.configureWizard(n,["General","Predecessors","Summary"])},d=function(){console.log(t.wizardItem)};n.hasNoKeys=function(n){for(k in n)if(Object.prototype.hasOwnProperty.call(n,k))return!1;return!0};n.createTask=function(){h.saveEntityAndCreate("Task","Milestone","taskEdit")};y=function(){var r,i;for(n.usersTypes=[{id:1,name:"ProductManager",users:[]},{id:2,name:"ProjectManager",users:[]},{id:4,name:"SystemEngineer",users:[]}],t.projectUserEmail=t.userEmail,r=0;r<t.data.Users.length;r++)i=t.data.Users[r],i.UserType&1&&n.usersTypes[0].users.push(i),i.UserType&2&&n.usersTypes[1].users.push(i),i.UserType&4&&n.usersTypes[2].users.push(i);t.userType=n.usersTypes[0];n.addUser=function(){for(var i=0;i<t.userType.users.length;i++)if(t.userType.users[i].UserMail==t.projectUserEmail){console.log(t.userType.users[i].UserMail+" is already a "+t.userType.name);return}t.userType.users.push({Id:-1,UserMail:t.projectUserEmail,ProjectId:t.wizardItem.Id,UserType:n.userType.id,Name:"A",Description:"A"})};n.removeUser=function(n,t){index=-1;for(var i=0;i<t.users.length;i++)if(t.users[i].UserMail===n.UserMail){index=i;break}index>-1&&t.users.splice(index,1)};var f=function(){console.log("deleted Project User")},e=function(){console.log("Created Project User")},o=function(){console.log("Updated Project User")},u=function(){console.log("failed to something project user")};n.saveUsers=function(){for(var i,r,l,a={},c={},v={},y={},h=0;h<t.data.Users.length;h++)y[t.data.Users[h].UserMail]=t.data.Users[h];for(i=0;i<n.usersTypes.length;i++)for(r=0;r<n.usersTypes[i].users.length;r++)y[n.usersTypes[i].users[r].UserMail]!=undefined?c[n.usersTypes[i].users[r].UserMail]!=undefined?c[n.usersTypes[i].users[r].UserMail].UserType|=n.usersTypes[i].users[r].UserType:c[n.usersTypes[i].users[r].UserMail]=n.usersTypes[i].users[r]:a[n.usersTypes[i].users[r].UserMail]!=undefined?a[n.usersTypes[i].users[r].UserMail].UserType|=n.usersTypes[i].users[r].UserType:a[n.usersTypes[i].users[r].UserMail]=n.usersTypes[i].users[r];for(h=0;h<t.data.Users.length;h++)c[t.data.Users[h].UserMail]||(v[t.data.Users[h].UserMail]=t.data.Users[h]);for(l in a)s.commitEntity(a[l],e,u,"ProjectUser");for(l in c)s.updateEntity(c[l],o,u,"ProjectUser");for(l in v)s.deleteEntity(v[l],f,u,"ProjectUser")}}}]);
/*
//# sourceMappingURL=searchCtrl.min.js.map
*/