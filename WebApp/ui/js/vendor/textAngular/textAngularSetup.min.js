/*
@license textAngular
Author : Austin Anderson
License : 2013 MIT
Version 1.3.7
See README.md or https://github.com/fraywing/textAngular/wiki for requirements and use.
*/
angular.module("textAngularSetup",[]).value("taOptions",{toolbar:[["h1","h2","h3","h4","h5","h6","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],["justifyLeft","justifyCenter","justifyRight","justifyFull","indent","outdent"],["html","insertImage","insertLink","insertVideo","wordcount","charcount"]],classes:{focussed:"focussed",toolbar:"btn-toolbar",toolbarGroup:"btn-group",toolbarButton:"btn btn-default",toolbarButtonActive:"active",disabled:"disabled",textEditor:"form-control",htmlEditor:"form-control"},setup:{textEditorSetup:function(){},htmlEditorSetup:function(){}},defaultFileDropHandler:function(n,t){var i=new FileReader;return n.type.substring(0,5)==="image"?(i.onload=function(){i.result!==""&&t("insertImage",i.result,!0)},i.readAsDataURL(n),!0):!1}}).value("taSelectableElements",["a","img"]).value("taCustomRenderers",[{selector:"img",customAttribute:"ta-insert-video",renderLogic:function(n){var t=angular.element("<iframe><\/iframe>"),i=n.prop("attributes");angular.forEach(i,function(n){t.attr(n.name,n.value)});t.attr("src",t.attr("ta-insert-video"));n.replaceWith(t)}}]).value("taTranslations",{html:{tooltip:"Toggle html / Rich Text"},heading:{tooltip:"Heading "},p:{tooltip:"Paragraph"},pre:{tooltip:"Preformatted text"},ul:{tooltip:"Unordered List"},ol:{tooltip:"Ordered List"},quote:{tooltip:"Quote/unquote selection or paragraph"},undo:{tooltip:"Undo"},redo:{tooltip:"Redo"},bold:{tooltip:"Bold"},italic:{tooltip:"Italic"},underline:{tooltip:"Underline"},strikeThrough:{tooltip:"Strikethrough"},justifyLeft:{tooltip:"Align text left"},justifyRight:{tooltip:"Align text right"},justifyCenter:{tooltip:"Center"},justifyFull:{tooltip:"Align text justify"},indent:{tooltip:"Increase indent"},outdent:{tooltip:"Decrease indent"},clear:{tooltip:"Clear formatting"},insertImage:{dialogPrompt:"Please enter an image URL to insert",tooltip:"Insert image",hotkey:"the - possibly language dependent hotkey ... for some future implementation"},insertVideo:{tooltip:"Insert video",dialogPrompt:"Please enter a youtube URL to embed"},insertLink:{tooltip:"Insert / edit link",dialogPrompt:"Please enter a URL to insert"},editLink:{reLinkButton:{tooltip:"Relink"},unLinkButton:{tooltip:"Unlink"},targetToggle:{buttontext:"Open in New Window"}},wordcount:{tooltip:"Display words Count"},charcount:{tooltip:"Display characters Count"}}).run(["taRegisterTool","$window","taTranslations","taSelection",function(n,t,i,r){var f,e,u;n("html",{iconclass:"fa fa-code",tooltiptext:i.html.tooltip,action:function(){this.$editor().switchView()},activeState:function(){return this.$editor().showHtml}});f=function(n){return function(){return this.$editor().queryFormatBlockState(n)}};e=function(){return this.$editor().wrapSelection("formatBlock","<"+this.name.toUpperCase()+">")};angular.forEach(["h1","h2","h3","h4","h5","h6"],function(t){n(t.toLowerCase(),{buttontext:t.toUpperCase(),tooltiptext:i.heading.tooltip+t.charAt(1),action:e,activeState:f(t.toLowerCase())})});n("p",{buttontext:"P",tooltiptext:i.p.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<P>")},activeState:function(){return this.$editor().queryFormatBlockState("p")}});n("pre",{buttontext:"pre",tooltiptext:i.pre.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<PRE>")},activeState:function(){return this.$editor().queryFormatBlockState("pre")}});n("ul",{iconclass:"fa fa-list-ul",tooltiptext:i.ul.tooltip,action:function(){return this.$editor().wrapSelection("insertUnorderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertUnorderedList")}});n("ol",{iconclass:"fa fa-list-ol",tooltiptext:i.ol.tooltip,action:function(){return this.$editor().wrapSelection("insertOrderedList",null)},activeState:function(){return this.$editor().queryCommandState("insertOrderedList")}});n("quote",{iconclass:"fa fa-quote-right",tooltiptext:i.quote.tooltip,action:function(){return this.$editor().wrapSelection("formatBlock","<BLOCKQUOTE>")},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}});n("undo",{iconclass:"fa fa-undo",tooltiptext:i.undo.tooltip,action:function(){return this.$editor().wrapSelection("undo",null)}});n("redo",{iconclass:"fa fa-repeat",tooltiptext:i.redo.tooltip,action:function(){return this.$editor().wrapSelection("redo",null)}});n("bold",{iconclass:"fa fa-bold",tooltiptext:i.bold.tooltip,action:function(){return this.$editor().wrapSelection("bold",null)},activeState:function(){return this.$editor().queryCommandState("bold")},commandKeyCode:98});n("justifyLeft",{iconclass:"fa fa-align-left",tooltiptext:i.justifyLeft.tooltip,action:function(){return this.$editor().wrapSelection("justifyLeft",null)},activeState:function(n){var t=!1;return n&&(t=n.css("text-align")==="left"||n.attr("align")==="left"||n.css("text-align")!=="right"&&n.css("text-align")!=="center"&&n.css("text-align")!=="justify"&&!this.$editor().queryCommandState("justifyRight")&&!this.$editor().queryCommandState("justifyCenter")&&!this.$editor().queryCommandState("justifyFull")),t||this.$editor().queryCommandState("justifyLeft")}});n("justifyFull",{iconclass:"fa fa-align-justify",tooltiptext:i.justifyFull.tooltip,action:function(){return this.$editor().wrapSelection("justifyFull",null)},activeState:function(n){var t=!1;return n&&(t=n.css("text-align")==="justify"),t||this.$editor().queryCommandState("justifyFull")}});n("justifyRight",{iconclass:"fa fa-align-right",tooltiptext:i.justifyRight.tooltip,action:function(){return this.$editor().wrapSelection("justifyRight",null)},activeState:function(n){var t=!1;return n&&(t=n.css("text-align")==="right"),t||this.$editor().queryCommandState("justifyRight")}});n("justifyCenter",{iconclass:"fa fa-align-center",tooltiptext:i.justifyCenter.tooltip,action:function(){return this.$editor().wrapSelection("justifyCenter",null)},activeState:function(n){var t=!1;return n&&(t=n.css("text-align")==="center"),t||this.$editor().queryCommandState("justifyCenter")}});n("indent",{iconclass:"fa fa-indent",tooltiptext:i.indent.tooltip,action:function(){return this.$editor().wrapSelection("indent",null)},activeState:function(){return this.$editor().queryFormatBlockState("blockquote")}});n("outdent",{iconclass:"fa fa-outdent",tooltiptext:i.outdent.tooltip,action:function(){return this.$editor().wrapSelection("outdent",null)},activeState:function(){return!1}});n("italics",{iconclass:"fa fa-italic",tooltiptext:i.italic.tooltip,action:function(){return this.$editor().wrapSelection("italic",null)},activeState:function(){return this.$editor().queryCommandState("italic")},commandKeyCode:105});n("underline",{iconclass:"fa fa-underline",tooltiptext:i.underline.tooltip,action:function(){return this.$editor().wrapSelection("underline",null)},activeState:function(){return this.$editor().queryCommandState("underline")},commandKeyCode:117});n("strikeThrough",{iconclass:"fa fa-strikethrough",tooltiptext:i.strikeThrough.tooltip,action:function(){return this.$editor().wrapSelection("strikeThrough",null)},activeState:function(){return document.queryCommandState("strikeThrough")}});n("clear",{iconclass:"fa fa-ban",tooltiptext:i.clear.tooltip,action:function(n,t){var i,u,c,f,o,l,a,p,v;if(this.$editor().wrapSelection("removeFormat",null),u=angular.element(r.getSelectionElement()),c=function(n){n=angular.element(n);var t=n;angular.forEach(n.children(),function(n){var i=angular.element("<p><\/p>");i.html(angular.element(n).html());t.after(i);t=i});n.remove()},angular.forEach(u.find("ul"),c),angular.forEach(u.find("ol"),c),u[0].tagName.toLowerCase()==="li"){var h=u[0].parentNode.childNodes,s=[],e=[],y=!1;for(i=0;i<h.length;i++)h[i]===u[0]?y=!0:y?e.push(h[i]):s.push(h[i]);if(f=angular.element(u[0].parentNode),o=angular.element("<p><\/p>"),o.html(angular.element(u[0]).html()),s.length===0||e.length===0)e.length===0?f.after(o):f[0].parentNode.insertBefore(o[0],f[0]),s.length===0&&e.length===0?f.remove():angular.element(u[0]).remove();else{for(l=angular.element("<"+f[0].tagName+"><\/"+f[0].tagName+">"),a=angular.element("<"+f[0].tagName+"><\/"+f[0].tagName+">"),i=0;i<s.length;i++)l.append(angular.element(s[i]));for(i=0;i<e.length;i++)a.append(angular.element(e[i]));f.after(a);f.after(o);f.after(l);f.remove()}r.setSelectionToElementEnd(o[0])}p=this.$editor();v=function(n){n=angular.element(n);n[0]!==p.displayElements.text[0]&&n.removeAttr("class");angular.forEach(n.children(),v)};angular.forEach(u,v);u[0].tagName.toLowerCase()!=="li"&&u[0].tagName.toLowerCase()!=="ol"&&u[0].tagName.toLowerCase()!=="ul"&&this.$editor().wrapSelection("formatBlock","default");t()}});u=function(n,t,i){var u=function(){i.updateTaBindtaTextElement();i.hidePopover()},f,r,e,o,s,h,c,l,a,v;n.preventDefault();i.displayElements.popover.css("width","375px");f=i.displayElements.popoverContainer;f.empty();r=angular.element('<div class="btn-group" style="padding-right: 6px;">');e=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">100% <\/button>');e.on("click",function(n){n.preventDefault();t.css({width:"100%",height:""});u()});o=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">50% <\/button>');o.on("click",function(n){n.preventDefault();t.css({width:"50%",height:""});u()});s=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">25% <\/button>');s.on("click",function(n){n.preventDefault();t.css({width:"25%",height:""});u()});h=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1">Reset<\/button>');h.on("click",function(n){n.preventDefault();t.css({width:"",height:""});u()});r.append(e);r.append(o);r.append(s);r.append(h);f.append(r);r=angular.element('<div class="btn-group" style="padding-right: 6px;">');c=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-left"><\/i><\/button>');c.on("click",function(n){n.preventDefault();t.css("float","left");t.css("cssFloat","left");t.css("styleFloat","left");u()});l=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-right"><\/i><\/button>');l.on("click",function(n){n.preventDefault();t.css("float","right");t.css("cssFloat","right");t.css("styleFloat","right");u()});a=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-align-justify"><\/i><\/button>');a.on("click",function(n){n.preventDefault();t.css("float","");t.css("cssFloat","");t.css("styleFloat","");u()});r.append(c);r.append(a);r.append(l);f.append(r);r=angular.element('<div class="btn-group">');v=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" unselectable="on" tabindex="-1"><i class="fa fa-trash-o"><\/i><\/button>');v.on("click",function(n){n.preventDefault();t.remove();u()});r.append(v);f.append(r);i.showPopover(t);i.showResizeOverlay(t)};n("insertImage",{iconclass:"fa fa-picture-o",tooltiptext:i.insertImage.tooltip,action:function(){var n;return n=t.prompt(i.insertImage.dialogPrompt,"http://"),n&&n!==""&&n!=="http://"?this.$editor().wrapSelection("insertImage",n,!0):void 0},onElementSelect:{element:"img",action:u}});n("insertVideo",{iconclass:"fa fa-youtube-play",tooltiptext:i.insertVideo.tooltip,action:function(){var n,r,u,f;return n=t.prompt(i.insertVideo.dialogPrompt,"https://"),n&&n!==""&&n!=="https://"&&(r=n.match(/(\?|&)v=[^&]*/),r&&r.length>0)?(u="https://www.youtube.com/embed/"+r[0].substring(3),f='<img class="ta-insert-video" src="https://img.youtube.com/vi/'+r[0].substring(3)+'/hqdefault.jpg" ta-insert-video="'+u+'" contenteditable="false" src="" allowfullscreen="true" frameborder="0" />',this.$editor().wrapSelection("insertHTML",f,!0)):void 0},onElementSelect:{element:"img",onlyWithAttrs:["ta-insert-video"],action:u}});n("insertLink",{tooltiptext:i.insertLink.tooltip,iconclass:"fa fa-link",action:function(){var n;return n=t.prompt(i.insertLink.dialogPrompt,"http://"),n&&n!==""&&n!=="http://"?this.$editor().wrapSelection("createLink",n,!0):void 0},activeState:function(n){return n?n[0].tagName==="A":!1},onElementSelect:{element:"a",action:function(n,r,u){var f,s,e,h,c,o;n.preventDefault();u.displayElements.popover.css("width","436px");f=u.displayElements.popoverContainer;f.empty();f.css("line-height","28px");s=angular.element('<a href="'+r.attr("href")+'" target="_blank">'+r.attr("href")+"<\/a>");s.css({display:"inline-block","max-width":"200px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","vertical-align":"middle"});f.append(s);e=angular.element('<div class="btn-group pull-right">');h=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+i.editLink.reLinkButton.tooltip+'"><i class="fa fa-edit icon-edit"><\/i><\/button>');h.on("click",function(n){n.preventDefault();var f=t.prompt(i.insertLink.dialogPrompt,r.attr("href"));f&&f!==""&&f!=="http://"&&(r.attr("href",f),u.updateTaBindtaTextElement());u.hidePopover()});e.append(h);c=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on" title="'+i.editLink.unLinkButton.tooltip+'"><i class="fa fa-unlink icon-unlink"><\/i><\/button>');c.on("click",function(n){n.preventDefault();r.replaceWith(r.contents());u.updateTaBindtaTextElement();u.hidePopover()});e.append(c);o=angular.element('<button type="button" class="btn btn-default btn-sm btn-small" tabindex="-1" unselectable="on">'+i.editLink.targetToggle.buttontext+"<\/button>");r.attr("target")==="_blank"&&o.addClass("active");o.on("click",function(n){n.preventDefault();r.attr("target",r.attr("target")==="_blank"?"":"_blank");o.toggleClass("active");u.updateTaBindtaTextElement()});e.append(o);f.append(e);u.showPopover(r)}}});n("wordcount",{display:'<div id="toolbarWC" style="display:block; min-width:100px;">Words: <span ng-bind="wordcount"><\/span><\/div>',disabled:!0,wordcount:0,activeState:function(){var i=this.$editor().displayElements.text,t=i[0].innerHTML||"",n=0;return t.replace(/\s*<[^>]*?>\s*/g,"")!==""&&(n=t.replace(/<\/?(b|i|em|strong|span|u|strikethrough|a|img|small|sub|sup|label)( [^>*?])?>/gi,"").replace(/(<[^>]*?>\s*<[^>]*?>)/ig," ").replace(/(<[^>]*?>)/ig,"").replace(/\s+/ig," ").match(/\S+/g).length),this.wordcount=n,this.$editor().wordcount=n,!1}});n("charcount",{display:'<div id="toolbarCC" style="display:block; min-width:120px;">Characters: <span ng-bind="charcount"><\/span><\/div>',disabled:!0,charcount:0,activeState:function(){var n=this.$editor().displayElements.text,i=n[0].innerText||n[0].textContent,t=i.replace(/(\r\n|\n|\r)/gm,"").replace(/^\s+/g," ").replace(/\s+$/g," ").length;return this.charcount=t,this.$editor().charcount=t,!1}})}]);
/*
//# sourceMappingURL=textAngularSetup.min.js.map
*/