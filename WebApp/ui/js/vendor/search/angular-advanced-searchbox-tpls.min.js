/*! 
 * angular-advanced-searchbox
 * https://github.com/dnauck/angular-advanced-searchbox
 * Copyright (c) 2015 Nauck IT KG http://www.nauck-it.de/
 * Author: Daniel Nauck <d.nauck(at)nauck-it.de>
 * License: MIT
 */
(function(){"use strict";angular.module("angular-advanced-searchbox",[]).directive("nitAdvancedSearchbox",function(){return{restrict:"E",scope:{model:"=ngModel",parameters:"="},replace:!0,templateUrl:"angular-advanced-searchbox.html",controller:["$scope","$attrs","$element","$timeout","$filter",function(n,t,i,r,u){function o(){angular.forEach(n.model,function(t,i){if(i==="query")n.searchQuery=t;else{var r=u("filter")(n.parameters,function(n){return n.key===i})[0];r!==undefined&&n.addSearchParam(r,t,!1)}})}function e(){f&&r.cancel(f);f=r(function(){n.model={};n.searchQuery.length>0&&(n.model.query=n.searchQuery);angular.forEach(n.searchParams,function(t){t.value!==undefined&&t.value.length>0&&(n.model[t.key]=t.value)})},500)}function s(n){if(!n)return 0;if(typeof n.selectionStart=="number")return n.selectionDirection==="backward"?n.selectionStart:n.selectionEnd;if(document.selection){n.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-n.value.length),t.text.length-i}return 0}n.placeholder=t.placeholder||"Search ...";n.searchParams=[];n.searchQuery="";n.setSearchFocus=!1;n.$watch("searchQuery",function(){e()});n.$watch("searchParams",function(){e()},!0);n.enterEditMode=function(t){if(t!==undefined){var i=n.searchParams[t];i.editMode=!0}};n.leaveEditMode=function(t){if(t!==undefined){var i=n.searchParams[t];i.editMode=!1;i.value||n.removeSearchParam(t)}};n.typeaheadOnSelect=function(t){n.addSearchParam(t);n.searchQuery=""};n.addSearchParam=function(t,i,r){r===undefined&&(r=!0);n.searchParams.push({key:t.key,name:t.name,placeholder:t.placeholder,value:i||"",editMode:r})};n.removeSearchParam=function(t){t!==undefined&&n.searchParams.splice(t,1)};n.removeAll=function(){n.searchParams.length=0;n.searchQuery=""};n.editPrevious=function(t){t!==undefined&&n.leaveEditMode(t);t>0?n.enterEditMode(t-1):n.searchParams.length>0&&n.enterEditMode(n.searchParams.length-1)};n.editNext=function(t){t!==undefined&&(n.leaveEditMode(t),t<n.searchParams.length-1?n.enterEditMode(t+1):n.setSearchFocus=!0)};n.keydown=function(t,i){var r;[8,9,13,37,39].indexOf(t.which)!==-1&&(r=s(t.target),t.which==8?r===0&&n.editPrevious(i):t.which==9?t.shiftKey?(t.preventDefault(),n.editPrevious(i)):(t.preventDefault(),n.editNext(i)):t.which==13?n.editNext(i):t.which==37?r===0&&n.editPrevious(i):t.which==39&&r===t.target.value.length&&n.editNext(i))};n.model===undefined?n.model={}:o();var f}]}}).directive("nitSetFocus",["$timeout","$parse",function(n,t){return{restrict:"A",link:function(i,r,u){var f=t(u.nitSetFocus);i.$watch(f,function(t){t===!0&&n(function(){r[0].focus()})});r.bind("blur",function(){i.$apply(f.assign(i,!1))})}}}]).directive("nitAutoSizeInput",[function(){return{restrict:"A",scope:{model:"=ngModel"},link:function(n,t){function r(){i.text(t.val()||t.attr("placeholder"));t.css("width",i.outerWidth()+10)}var u=angular.element('<div style="position: fixed; top: -9999px; left: 0px;"><\/div>'),i=angular.element('<span style="white-space:pre;"><\/span>'),f=t.css("maxWidth")==="none"?t.parent().innerWidth():t.css("maxWidth");if(t.css("maxWidth",f),angular.forEach(["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","boxSizing","borderLeftWidth","borderRightWidth","borderLeftStyle","borderRightStyle","paddingLeft","paddingRight","marginLeft","marginRight"],function(n){i.css(n,t.css(n))}),angular.element("body").append(u.append(i)),r(),n.model)n.$watch("model",function(){r()});else t.on("keypress keyup keydown focus input propertychange change",function(){r()})}}}])})();angular.module("angular-advanced-searchbox").run(["$templateCache",function(n){"use strict";n.put("angular-advanced-searchbox.html",'<div class=advancedSearchBox ng-class={active:focus} ng-init="focus = false"><span ng-show="searchParams.length < 1 && searchQuery.length === 0" class="search-icon glyphicon glyphicon-search"><\/span> <a ng-href="" ng-show="searchParams.length > 0 || searchQuery.length > 0" ng-click=removeAll() role=button><span class="remove-all-icon glyphicon glyphicon-trash"><\/span><\/a><div><div class=search-parameter ng-repeat="searchParam in searchParams"><a ng-href="" ng-click=removeSearchParam($index) role=button><span class="remove glyphicon glyphicon-trash"><\/span><\/a><div class=key>{{searchParam.name}}:<\/div><div class=value><span ng-show=!searchParam.editMode ng-click=enterEditMode($index)>{{searchParam.value}}<\/span> <input name=value nit-auto-size-input nit-set-focus=searchParam.editMode ng-keydown="keydown($event, $index)" ng-blur=leaveEditMode($index) ng-show=searchParam.editMode ng-model=searchParam.value placeholder="{{searchParam.placeholder}}"><\/div><\/div><input name=searchbox class=search-parameter-input nit-set-focus=setSearchFocus ng-keydown=keydown($event) placeholder={{placeholder}} ng-focus="focus = true" ng-blur="focus = false" typeahead-on-select="typeaheadOnSelect($item, $model, $label)" typeahead="parameter as parameter.name for parameter in parameters | filter:{name:$viewValue} | limitTo:8" ng-model="searchQuery"><\/div><div class=search-parameter-suggestions ng-show="parameters && focus"><span class=title>Parameter Suggestions:<\/span> <span class=search-parameter ng-repeat="param in parameters | limitTo:8" ng-mousedown=addSearchParam(param)>{{param.name}}<\/span><\/div><\/div>')}]);
/*
//# sourceMappingURL=angular-advanced-searchbox-tpls.min.js.map
*/